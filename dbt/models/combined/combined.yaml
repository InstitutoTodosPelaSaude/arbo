sources:
  - name: age_groups
    description: Table to map age groups created by dbt seed
    schema: arboviroses
    tables:
      - name: age_groups
  - name: epiweeks
    description: Table to map epiweeks created by dbt seed
    schema: arboviroses
    tables:
      - name: epiweeks
  - name: fix_location
    description: Table to fix locations with mistakes created by dbt seed
    schema: arboviroses
    tables:
      - name: fix_location
  - name: municipios
    description: Table to map location created by dbt seed
    schema: arboviroses
    tables:
      - name: municipios

models:
  - name: combined_01_join_labs
    description: Join all labs in one table
    columns:
      - name: sample_id
        tests:
          - unique

  - name: combined_02_age_groups
    description: Add age groups to combined table
    columns:
      - name: sample_id
        tests:
          - unique
          - relationships:
              to: ref('combined_01_join_labs')
              field: sample_id

  - name: combined_03_dates
    description: Add epiweeks to combined table
    columns:
      - name: sample_id
        tests:
          - unique
          - relationships:
              to: ref('combined_02_age_groups')
              field: sample_id

  - name: combined_04_fix_location
    description: Fix location name with mistakes in combined table 
    columns:
      - name: sample_id
        tests:
          - unique
          - relationships:
              to: ref('combined_03_dates')
              field: sample_id

  - name: combined_05_location
    description: Add location info to combined table
    columns:
      - name: sample_id
        tests:
          - unique
          - relationships:
              to: ref('combined_04_fix_location')
              field: sample_id
